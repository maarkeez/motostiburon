<div data-th-fragment="fragment">

	<div class="col-sm-12">
		<div class="form-group">
			<div class="col-sm-5"></div>
			<label class="col-sm-2 control-label">Origen</label>
			<div class="col-sm-5">
				<input class="form-control" id="origen" type="text"
					onchange="setOrigen()" data-th-value="${origen}" />
			</div>
		</div>

		<div class="form-group">
			<div class="col-sm-5"></div>
			<label class="col-sm-2 control-label">Origen</label>
			<div class="col-sm-5">
				<input class="form-control" id="destino" type="text"
					onchange="setDestino();" data-th-value="${destino}" />
			</div>
		</div>
	</div>
	<div class="col-sm-12">
		<div id="map"
			style="height: 350px; width: 525px; right: 0px; float: right;"></div>
	</div>


	<script data-th-inline="javascript">
		// <![CDATA[

		/********************************
		 * Mapa
		 ********************************/
		var map;
		var geoCoder;

		function initMap() {
			map = new google.maps.Map(document.getElementById('map'), {
				center : {
					lat : -34.397,
					lng : 150.644
				},
				zoom : 17
			});
			geocoder = new google.maps.Geocoder();

			var infoWindow = new google.maps.InfoWindow({
				map : map
			});

			setOrigen();
			setDestino();

			
		}

		function getCurrentAddres() {

			if (navigator.geolocation) {
				navigator.geolocation.getCurrentPosition(function(position) {
					var pos = {
						lat : position.coords.latitude,
						lng : position.coords.longitude
					};

					var marker = new google.maps.Marker({
						position : pos,
						map : map,
					});

					map.setCenter(pos);
				}, function() {
					handleLocationError(true, infoWindow, map.getCenter());
				});
			} else {
				// Browser doesn't support Geolocation
				handleLocationError(false, infoWindow, map.getCenter());
			}
		}
		
		function handleLocationError(browserHasGeolocation, infoWindow, pos) {
			infoWindow.setPosition(pos);
			infoWindow
					.setContent(browserHasGeolocation ? 'Error: The Geolocation service failed.'
							: 'Error: Your browser doesn\'t support geolocation.');
		}
		
		function geocodeAddress(address) {
			console.log("Geocoding addres: " + address);
			geocoder
					.geocode(
							{
								'address' : address
							},
							function(results, status) {
								if (status === 'OK') {
									console
											.log("DirecciÃ³n encontrada. RESULTS ==> ");
									console.log(results);

									map.setCenter(results[0].geometry.location);

									var marker = new google.maps.Marker({
										map : map,
										position : results[0].geometry.location
									});
									map.setZoom(15);
								} else {
									alert('Geocode was not successful for the following reason: '
											+ status);
								}
							});
		}

		function setOrigen() {
			var address = document.getElementById('origen').value;
			geocodeAddress(address);
		}

		function setDestino() {
			var address = document.getElementById('destino').value;
			geocodeAddress(address);
		}
		
		function calcRoute() {
			  var selectedMode = 'DRIVING';
			  var request = {
			      origin: 
		haight,
				destination : oceanBeach,
				// Note that Javascript allows us to access the constant
				// using square brackets and a string value as its
				// "property."
				travelMode : google.maps.TravelMode[selectedMode]
			};
			directionsService.route(request, function(response, status) {
				if (status == 'OK') {
					directionsDisplay.setDirections(response);
				}
			});
		}
		
		var directionsDisplay;
		var directionsService = new google.maps.DirectionsService();
		function initialize() {
			  directionsDisplay = new google.maps.DirectionsRenderer();
			  var mapOptions = {
			    zoom: 14,
			    center: haight
			  }
			  map = new google.maps.Map(document.getElementById('map'), mapOptions);
			  directionsDisplay.setMap(map);
			}

		// ]]>
	</script>


	<script
		src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDJOu9rzWpuJzuybS0Q78JRwNk-O9J7g6Q&amp;callback=initMap"
		async="async" defer="defer"></script>


</div>